(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{411:function(e,s,t){"use strict";t.r(s);var a=t(54),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"my-logging-best-practices"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#my-logging-best-practices"}},[e._v("#")]),e._v(" "),t("a",{attrs:{href:"https://tuhrig.de/my-logging-best-practices/",target:"_blank",rel:"noopener noreferrer"}},[e._v("My Logging Best Practices"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("If you are a backend developer like me, logging is the window to your application. Unlike in the frontend, there’s not much to see except from some logging messages. Here are some of my personal guidelines I use when I write logs.")]),e._v(" "),t("h2",{attrs:{id:"log-after-not-before"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#log-after-not-before"}},[e._v("#")]),e._v(" Log after, not before")]),e._v(" "),t("p",[e._v("Back in the days, a logbook was written on every ship. It was like a diary which recorded important events throughout the day. And just like a traditional logbook, we should log things that had happened instead of things we are going to do.")]),e._v(" "),t("p",[e._v("Let’s make an example:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('// don\'t do that\nlog.info("Making request to REST API")\nrestClient.makeRequest()\n \n// do that\nrestClient.makeRequest()\nlog.info("Made request to REST API")\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[e._v("The first log statement doesn’t tell much. When reading it, you will not know if the REST call was successful or not. To do so you must look for the absence of an exception. And if you read this log but miss the subsequent exception you will be confused for the rest of the day (trust me).")]),e._v(" "),t("p",[e._v("The second log is much better. It clearly states that the operation right before was successful. If the REST call would have failed, you would not see this log – there would be an exception instead.")]),e._v(" "),t("p",[e._v("I apply this rule to all INFO logs. However I make exceptions for DEBUG.")]),e._v(" "),t("h2",{attrs:{id:"separate-parameters-and-messages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#separate-parameters-and-messages"}},[e._v("#")]),e._v(" Separate parameters and messages")]),e._v(" "),t("p",[e._v("A typical log message contains two types of data. One type is a handwritten message which states was is going on. The second type is a list of (technical) parameters involved in the operation. You should try to separate both parts.")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('// don\'t do that\nrestClient.makeRequest()\nlog.info("Made request to {} on REST API.", url)\n \n// do that\nrestClient.makeRequest()\nlog.info("Made request to REST API. [url={}]", url)\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[e._v("The first log message has some flaws. It’s difficult to parse for example for Grok patterns. So it becomes harder to automatically extract IDs or parameters in our logging tool. It’s also difficult to read. Imagine having a very long URL possibly with a list of parameters at their end. Half of the log message might be out of your screen. And of course, the message is more difficult to extend. If you want to add another parameter (such as the HTTP method used) you must rewrite you whole sentence.")]),e._v(" "),t("p",[e._v("The seconds version has none of these flaws. It’s easy to parse because the parameter list has a clear syntax. It’s easy to read, as you can see the sentence right up-front. And it’s easy to extend as you can just add another parameter to the list.")]),e._v(" "),t("h2",{attrs:{id:"distinguish-between-warning-and-error"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#distinguish-between-warning-and-error"}},[e._v("#")]),e._v(" Distinguish between WARNING and ERROR")]),e._v(" "),t("p",[e._v("Obviously, log levels are there for a reason and you should use them appropriately. And there are some key differences between a WARNING and an ERROR.")]),e._v(" "),t("p",[e._v("If you did some operations which actually worked, but there have been some issues – that’s a WARNING. But if you did some operation and it simply didn’t work – that’s an ERROR.")]),e._v(" "),t("p",[e._v("Let’s look at an example again:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('try {\n    restClient.makeRequest()\n    log.info("Made request to REST API. [url={}]", url)\n} catch(e: UnauthorizedException) {\n    log.warn("Request to REST API was rejected because user is unauthorized. [url={}, result={}]", url, result)\n} catch(e: Exception) {\n    log.error("Request to REST API failed. [url={}, exception={}]", url, exception)\n}\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("p",[e._v("The REST call might have one of three outcomes:")]),e._v(" "),t("ul",[t("li",[e._v("It can work like a charm. That’s an INFO ("),t("em",[e._v("after")]),e._v(" the call).")]),e._v(" "),t("li",[e._v("It can fail with an unexpected exception. That’s an ERROR ("),t("em",[e._v("instead")]),e._v(" of the INFO log).")]),e._v(" "),t("li",[e._v("It can result in some expected exception. That’s a WARNING.")])]),e._v(" "),t("p",[e._v("So in case of a WARNING, you did something, but you didn’t do it perfectly. In case of an ERROR you didn’t do it.")]),e._v(" "),t("p",[e._v("Also note that a WARNING (and also an ERROR of course) is a call to action. If nobody needs to react and to do something, then you don’t need to log a WARNING.")]),e._v(" "),t("h2",{attrs:{id:"info-is-for-business-debug-for-technology"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#info-is-for-business-debug-for-technology"}},[e._v("#")]),e._v(" INFO is for business, DEBUG for technology")]),e._v(" "),t("p",[e._v("The INFO log should look like a book. It should tell you what had happened, not necessarily how. This means that INFO is better suited for business-like log messages compared to technical stuff. Technical related messages should (usually) be DEBUG.")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('INFO  | User registered for newsletter. [user="Thomas", email="thomas@tuhrig.de"]\nINFO  | Newsletter send to user. [user="Thomas"]\nINFO  | User unsubscribed from newsletter. [user="Thomas", email="thomas@tuhrig.de"]\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("This type of log tells you a story from the point of view of our business. Now what are technical logs?")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('DEBUG | Saved user to newsletter list. [user="Thomas", email="thomas@tuhrig.de"]\nDEBUG | Send welcome mail. [user="Thomas", email="thomas@tuhrig.de"]\nINFO  | User registered for newsletter. [user="Thomas", email="thomas@tuhrig.de"]\nDEBUG | Started cron job to send newsletter of the day. [subscribers=24332]\nINFO  | Newsletter send to user. [user="Thomas"]\nINFO  | User unsubscribed from newsletter. [user="Thomas", email="thomas@tuhrig.de"]\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[e._v("Every (business) use-case results in a single line of INFO log. Additionally, there are DEBUG logs which give a more detailed insight in how the process works.")]),e._v(" "),t("h2",{attrs:{id:"much-more"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#much-more"}},[e._v("#")]),e._v(" Much more")]),e._v(" "),t("p",[e._v("Of course, there’s much more to do for good logs. You also need to consider things like tracing, log aggregation and metrics. But when it comes down to the pure writing, I really recommend those little rules.")])])}),[],!1,null,null,null);s.default=n.exports}}]);